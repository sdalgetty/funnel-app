-- Create Local Development Test Account (Final Version)
-- Run this in Supabase SQL Editor to set up a dedicated test account for local development
-- This account will have comprehensive mock data for testing all features

-- First, clean up any existing test account
DELETE FROM user_profiles WHERE email = 'test@localdev.com';
DELETE FROM auth.users WHERE email = 'test@localdev.com';

-- Create the test auth user
INSERT INTO auth.users (
  id,
  instance_id,
  aud,
  role,
  email,
  encrypted_password,
  email_confirmed_at,
  created_at,
  updated_at,
  confirmation_token,
  email_change,
  email_change_token_new,
  recovery_token
) VALUES (
  '00000000-0000-0000-0000-000000000001', -- Fixed UUID for test account
  '00000000-0000-0000-0000-000000000000',
  'authenticated',
  'authenticated',
  'test@localdev.com',
  crypt('testpassword123', gen_salt('bf')),
  now(),
  now(),
  now(),
  '',
  '',
  '',
  ''
);

-- Create the user profile with Pro permissions
INSERT INTO user_profiles (
  id,
  email,
  full_name,
  company_name,
  subscription_tier,
  subscription_status,
  created_at,
  updated_at
) VALUES (
  '00000000-0000-0000-0000-000000000001',
  'test@localdev.com',
  'Local Dev Tester',
  'Test Company',
  'pro',
  'active',
  now(),
  now()
);

-- Create service types
INSERT INTO service_types (id, user_id, name, description, created_at, updated_at) VALUES
  ('00000000-0000-0000-0000-000000000010', '00000000-0000-0000-0000-000000000001', 'Consultation', 'Initial consultation service', now(), now()),
  ('00000000-0000-0000-0000-000000000011', '00000000-0000-0000-0000-000000000001', 'Implementation', 'Full implementation service', now(), now()),
  ('00000000-0000-0000-0000-000000000012', '00000000-0000-0000-0000-000000000001', 'Support', 'Ongoing support service', now(), now()),
  ('00000000-0000-0000-0000-000000000013', '00000000-0000-0000-0000-000000000001', 'Strategy', 'Strategic planning service', now(), now()),
  ('00000000-0000-0000-0000-000000000014', '00000000-0000-0000-0000-000000000001', 'Training', 'Training and education service', now(), now());

-- Create lead sources
INSERT INTO lead_sources (id, user_id, name, description, created_at, updated_at) VALUES
  ('00000000-0000-0000-0000-000000000020', '00000000-0000-0000-0000-000000000001', 'Website', 'Direct website inquiries', now(), now()),
  ('00000000-0000-0000-0000-000000000021', '00000000-0000-0000-0000-000000000001', 'Referral', 'Client referrals', now(), now()),
  ('00000000-0000-0000-0000-000000000022', '00000000-0000-0000-0000-000000000001', 'Social Media', 'Social media inquiries', now(), now()),
  ('00000000-0000-0000-0000-000000000023', '00000000-0000-0000-0000-000000000001', 'Google Ads', 'Google advertising', now(), now()),
  ('00000000-0000-0000-0000-000000000024', '00000000-0000-0000-0000-000000000001', 'Instagram Ads', 'Instagram advertising', now(), now()),
  ('00000000-0000-0000-0000-000000000025', '00000000-0000-0000-0000-000000000001', 'LinkedIn', 'LinkedIn inquiries', now(), now()),
  ('00000000-0000-0000-0000-000000000026', '00000000-0000-0000-0000-000000000001', 'Email Marketing', 'Email marketing campaigns', now(), now());

-- Create ad sources
INSERT INTO ad_sources (id, user_id, name, lead_source_id, created_at, updated_at) VALUES
  ('00000000-0000-0000-0000-000000000030', '00000000-0000-0000-0000-000000000001', 'Google Ads', '00000000-0000-0000-0000-000000000023', now(), now()),
  ('00000000-0000-0000-0000-000000000031', '00000000-0000-0000-0000-000000000001', 'Instagram Ads', '00000000-0000-0000-0000-000000000024', now(), now()),
  ('00000000-0000-0000-0000-000000000032', '00000000-0000-0000-0000-000000000001', 'Facebook Ads', '00000000-0000-0000-0000-000000000024', now(), now()),
  ('00000000-0000-0000-0000-000000000033', '00000000-0000-0000-0000-000000000001', 'LinkedIn Ads', '00000000-0000-0000-0000-000000000025', now(), now());

-- Create sample bookings
INSERT INTO bookings (id, user_id, client_name, client_email, client_phone, service_type_id, lead_source_id, booking_date, status, notes, created_at, updated_at) VALUES
  ('00000000-0000-0000-0000-000000000050', '00000000-0000-0000-0000-000000000001', 'E-commerce Strategy', 'john@example.com', '555-0123', '00000000-0000-0000-0000-000000000010', '00000000-0000-0000-0000-000000000020', '2024-01-15', 'confirmed', 'Initial consultation for e-commerce strategy', now(), now()),
  ('00000000-0000-0000-0000-000000000051', '00000000-0000-0000-0000-000000000001', 'Social Media Campaign', 'jane@example.com', '555-0456', '00000000-0000-0000-0000-000000000011', '00000000-0000-0000-0000-000000000022', '2024-01-18', 'confirmed', 'Full implementation of social media strategy', now(), now()),
  ('00000000-0000-0000-0000-000000000052', '00000000-0000-0000-0000-000000000001', 'Website Redesign', 'bob@example.com', '555-0789', '00000000-0000-0000-0000-000000000011', '00000000-0000-0000-0000-000000000021', '2024-02-01', 'confirmed', 'Complete website redesign and development', now(), now()),
  ('00000000-0000-0000-0000-000000000053', '00000000-0000-0000-0000-000000000001', 'SEO Optimization', 'alice@example.com', '555-0321', '00000000-0000-0000-0000-000000000012', '00000000-0000-0000-0000-000000000023', '2024-02-10', 'pending', 'Ongoing SEO support and optimization', now(), now()),
  ('00000000-0000-0000-0000-000000000054', '00000000-0000-0000-0000-000000000001', 'Brand Strategy Workshop', 'charlie@example.com', '555-0654', '00000000-0000-0000-0000-000000000013', '00000000-0000-0000-0000-000000000025', '2024-02-20', 'confirmed', 'Full-day brand strategy workshop', now(), now()),
  ('00000000-0000-0000-0000-000000000055', '00000000-0000-0000-0000-000000000001', 'Marketing Automation', 'diana@example.com', '555-0987', '00000000-0000-0000-0000-000000000011', '00000000-0000-0000-0000-000000000026', '2024-03-05', 'confirmed', 'Marketing automation setup and training', now(), now()),
  ('00000000-0000-0000-0000-000000000056', '00000000-0000-0000-0000-000000000001', 'Content Strategy', 'eve@example.com', '555-0123', '00000000-0000-0000-0000-000000000013', '00000000-0000-0000-0000-000000000020', '2024-03-15', 'confirmed', 'Content strategy development and planning', now(), now()),
  ('00000000-0000-0000-0000-000000000057', '00000000-0000-0000-0000-000000000001', 'Analytics Setup', 'frank@example.com', '555-0456', '00000000-0000-0000-0000-000000000012', '00000000-0000-0000-0000-000000000023', '2024-03-25', 'pending', 'Google Analytics and tracking setup', now(), now());

-- Create sample payments
INSERT INTO payments (id, user_id, booking_id, amount_cents, payment_date, payment_method, status, notes, created_at, updated_at) VALUES
  ('00000000-0000-0000-0000-000000000060', '00000000-0000-0000-0000-000000000001', '00000000-0000-0000-0000-000000000050', 500000, '2024-02-01', 'credit_card', 'completed', 'E-commerce strategy consultation', now(), now()),
  ('00000000-0000-0000-0000-000000000061', '00000000-0000-0000-0000-000000000001', '00000000-0000-0000-0000-000000000051', 350000, '2024-02-15', 'bank_transfer', 'completed', 'Social media campaign implementation', now(), now()),
  ('00000000-0000-0000-0000-000000000062', '00000000-0000-0000-0000-000000000001', '00000000-0000-0000-0000-000000000052', 400000, '2024-03-01', 'credit_card', 'completed', 'Website redesign - 50% deposit', now(), now()),
  ('00000000-0000-0000-0000-000000000063', '00000000-0000-0000-0000-000000000001', '00000000-0000-0000-0000-000000000052', 400000, '2024-04-01', 'credit_card', 'pending', 'Website redesign - final payment', now(), now()),
  ('00000000-0000-0000-0000-000000000064', '00000000-0000-0000-0000-000000000001', '00000000-0000-0000-0000-000000000054', 450000, '2024-03-20', 'credit_card', 'completed', 'Brand strategy workshop', now(), now()),
  ('00000000-0000-0000-0000-000000000065', '00000000-0000-0000-0000-000000000001', '00000000-0000-0000-0000-000000000055', 300000, '2024-04-05', 'bank_transfer', 'completed', 'Marketing automation setup', now(), now()),
  ('00000000-0000-0000-0000-000000000066', '00000000-0000-0000-0000-000000000001', '00000000-0000-0000-0000-000000000056', 250000, '2024-04-15', 'credit_card', 'completed', 'Content strategy development', now(), now());

-- Create funnel data for 2024 (using correct column names - no created_at/updated_at)
INSERT INTO funnels (id, user_id, year, month, inquiries, calls_booked, calls_taken, closes, bookings, cash, name, bookings_goal, inquiry_to_call, call_to_booking, inquiries_ytd, calls_ytd, bookings_ytd, last_updated) VALUES
  ('00000000-0000-0000-0000-000000000070', '00000000-0000-0000-0000-000000000001', 2024, 1, 31, 16, 14, 4, 2909742, 2909742, '2024 January', 50, 0.52, 0.29, 31, 16, 4, now()),
  ('00000000-0000-0000-0000-000000000071', '00000000-0000-0000-0000-000000000001', 2024, 2, 28, 11, 11, 1, 1287400, 1287400, '2024 February', 50, 0.39, 0.09, 59, 27, 5, now()),
  ('00000000-0000-0000-0000-000000000072', '00000000-0000-0000-0000-000000000001', 2024, 3, 19, 9, 9, 8, 3895900, 3895900, '2024 March', 50, 0.47, 0.89, 78, 36, 13, now()),
  ('00000000-0000-0000-0000-000000000073', '00000000-0000-0000-0000-000000000001', 2024, 4, 19, 5, 5, 0, 1343811, 1343811, '2024 April', 50, 0.26, 0.00, 97, 41, 13, now()),
  ('00000000-0000-0000-0000-000000000074', '00000000-0000-0000-0000-000000000001', 2024, 5, 15, 5, 5, 2, 1674800, 1674800, '2024 May', 50, 0.33, 0.40, 112, 46, 15, now()),
  ('00000000-0000-0000-0000-000000000075', '00000000-0000-0000-0000-000000000001', 2024, 6, 11, 7, 5, 0, 773800, 773800, '2024 June', 50, 0.64, 0.00, 123, 53, 15, now()),
  ('00000000-0000-0000-0000-000000000076', '00000000-0000-0000-0000-000000000001', 2024, 7, 10, 6, 6, 2, 1804421, 1804421, '2024 July', 50, 0.60, 0.33, 133, 59, 17, now()),
  ('00000000-0000-0000-0000-000000000077', '00000000-0000-0000-0000-000000000001', 2024, 8, 14, 8, 8, 2, 1621800, 1621800, '2024 August', 50, 0.57, 0.25, 147, 67, 19, now()),
  ('00000000-0000-0000-0000-000000000078', '00000000-0000-0000-0000-000000000001', 2024, 9, 26, 11, 11, 8, 5423600, 5423600, '2024 September', 50, 0.42, 0.73, 173, 78, 27, now()),
  ('00000000-0000-0000-0000-000000000079', '00000000-0000-0000-0000-000000000001', 2024, 10, 13, 6, 6, 1, 1084260, 1084260, '2024 October', 50, 0.46, 0.17, 186, 84, 28, now()),
  ('00000000-0000-0000-0000-00000000007a', '00000000-0000-0000-0000-000000000001', 2024, 11, 20, 12, 10, 1, 678400, 678400, '2024 November', 50, 0.60, 0.10, 206, 96, 29, now()),
  ('00000000-0000-0000-0000-00000000007b', '00000000-0000-0000-0000-000000000001', 2024, 12, 28, 20, 17, 6, 4116000, 4116000, '2024 December', 50, 0.71, 0.35, 234, 116, 35, now());

-- Create funnel data for 2025 (current year)
INSERT INTO funnels (id, user_id, year, month, inquiries, calls_booked, calls_taken, closes, bookings, cash, name, bookings_goal, inquiry_to_call, call_to_booking, inquiries_ytd, calls_ytd, bookings_ytd, last_updated) VALUES
  ('00000000-0000-0000-0000-000000000080', '00000000-0000-0000-0000-000000000001', 2025, 1, 20, 12, 12, 9, 6125600, 6125600, '2025 January', 50, 0.60, 0.75, 20, 12, 9, now()),
  ('00000000-0000-0000-0000-000000000081', '00000000-0000-0000-0000-000000000001', 2025, 2, 18, 10, 9, 4, 2560000, 2560000, '2025 February', 50, 0.56, 0.44, 38, 22, 13, now()),
  ('00000000-0000-0000-0000-000000000082', '00000000-0000-0000-0000-000000000001', 2025, 3, 28, 17, 17, 5, 3200000, 3200000, '2025 March', 50, 0.61, 0.29, 66, 39, 18, now()),
  ('00000000-0000-0000-0000-000000000083', '00000000-0000-0000-0000-000000000001', 2025, 4, 22, 11, 10, 3, 1800000, 1800000, '2025 April', 50, 0.50, 0.30, 88, 50, 21, now()),
  ('00000000-0000-0000-0000-000000000084', '00000000-0000-0000-0000-000000000001', 2025, 5, 28, 14, 13, 2, 1200000, 1200000, '2025 May', 50, 0.50, 0.15, 116, 64, 23, now()),
  ('00000000-0000-0000-0000-000000000085', '00000000-0000-0000-0000-000000000001', 2025, 6, 15, 7, 6, 1, 800000, 800000, '2025 June', 50, 0.47, 0.17, 131, 71, 24, now()),
  ('00000000-0000-0000-0000-000000000086', '00000000-0000-0000-0000-000000000001', 2025, 7, 19, 9, 8, 0, 100000, 100000, '2025 July', 50, 0.47, 0.00, 150, 80, 24, now()),
  ('00000000-0000-0000-0000-000000000087', '00000000-0000-0000-0000-000000000001', 2025, 8, 16, 8, 7, 1, 500000, 500000, '2025 August', 50, 0.50, 0.14, 166, 88, 25, now()),
  ('00000000-0000-0000-0000-000000000088', '00000000-0000-0000-0000-000000000001', 2025, 9, 21, 10, 9, 1, 300000, 300000, '2025 September', 50, 0.48, 0.11, 187, 98, 26, now()),
  ('00000000-0000-0000-0000-000000000089', '00000000-0000-0000-0000-000000000001', 2025, 10, 17, 8, 7, 0, 0, 0, '2025 October', 50, 0.47, 0.00, 204, 106, 26, now()),
  ('00000000-0000-0000-0000-00000000008a', '00000000-0000-0000-0000-000000000001', 2025, 11, 14, 6, 5, 0, 0, 0, '2025 November', 50, 0.43, 0.00, 218, 112, 26, now()),
  ('00000000-0000-0000-0000-00000000008b', '00000000-0000-0000-0000-000000000001', 2025, 12, 12, 5, 4, 0, 0, 0, '2025 December', 50, 0.42, 0.00, 230, 117, 26, now());

-- Create ad campaigns for 2024 (sample months)
INSERT INTO ad_campaigns (id, user_id, ad_source_id, month_year, ad_spend_cents, leads_generated, last_updated, created_at, updated_at) VALUES
  ('00000000-0000-0000-0000-000000000090', '00000000-0000-0000-0000-000000000001', '00000000-0000-0000-0000-000000000030', '2024-01', 150000, 12, now(), now(), now()),
  ('00000000-0000-0000-0000-000000000091', '00000000-0000-0000-0000-000000000001', '00000000-0000-0000-0000-000000000031', '2024-01', 80000, 8, now(), now(), now()),
  ('00000000-0000-0000-0000-000000000092', '00000000-0000-0000-0000-000000000001', '00000000-0000-0000-0000-000000000030', '2024-02', 200000, 18, now(), now(), now()),
  ('00000000-0000-0000-0000-000000000093', '00000000-0000-0000-0000-000000000001', '00000000-0000-0000-0000-000000000031', '2024-02', 120000, 15, now(), now(), now()),
  ('00000000-0000-0000-0000-000000000094', '00000000-0000-0000-0000-000000000001', '00000000-0000-0000-0000-000000000030', '2024-03', 180000, 16, now(), now(), now()),
  ('00000000-0000-0000-0000-000000000095', '00000000-0000-0000-0000-000000000001', '00000000-0000-0000-0000-000000000031', '2024-03', 100000, 12, now(), now(), now());

-- Create ad campaigns for 2025 (current year)
INSERT INTO ad_campaigns (id, user_id, ad_source_id, month_year, ad_spend_cents, leads_generated, last_updated, created_at, updated_at) VALUES
  ('00000000-0000-0000-0000-000000000096', '00000000-0000-0000-0000-000000000001', '00000000-0000-0000-0000-000000000030', '2025-01', 250000, 22, now(), now(), now()),
  ('00000000-0000-0000-0000-000000000097', '00000000-0000-0000-0000-000000000001', '00000000-0000-0000-0000-000000000031', '2025-01', 130000, 16, now(), now(), now()),
  ('00000000-0000-0000-0000-000000000098', '00000000-0000-0000-0000-000000000001', '00000000-0000-0000-0000-000000000030', '2025-02', 200000, 18, now(), now(), now()),
  ('00000000-0000-0000-0000-000000000099', '00000000-0000-0000-0000-000000000001', '00000000-0000-0000-0000-000000000031', '2025-02', 110000, 14, now(), now(), now()),
  ('00000000-0000-0000-0000-00000000009a', '00000000-0000-0000-0000-000000000001', '00000000-0000-0000-0000-000000000030', '2025-03', 280000, 25, now(), now(), now()),
  ('00000000-0000-0000-0000-00000000009b', '00000000-0000-0000-0000-000000000001', '00000000-0000-0000-0000-000000000031', '2025-03', 150000, 18, now(), now(), now());

-- Verify the test account was created successfully
SELECT 
  'Test Account Created' as status,
  email, 
  full_name, 
  company_name, 
  subscription_tier, 
  subscription_status 
FROM user_profiles 
WHERE email = 'test@localdev.com';

-- Show data summary
SELECT 'Service Types' as table_name, COUNT(*) as count FROM service_types WHERE user_id = '00000000-0000-0000-0000-000000000001'
UNION ALL
SELECT 'Lead Sources', COUNT(*) FROM lead_sources WHERE user_id = '00000000-0000-0000-0000-000000000001'
UNION ALL
SELECT 'Funnel Data', COUNT(*) FROM funnels WHERE user_id = '00000000-0000-0000-0000-000000000001'
UNION ALL
SELECT 'Bookings', COUNT(*) FROM bookings WHERE user_id = '00000000-0000-0000-0000-000000000001'
UNION ALL
SELECT 'Payments', COUNT(*) FROM payments WHERE user_id = '00000000-0000-0000-0000-000000000001'
UNION ALL
SELECT 'Ad Sources', COUNT(*) FROM ad_sources WHERE user_id = '00000000-0000-0000-0000-000000000001'
UNION ALL
SELECT 'Ad Campaigns', COUNT(*) FROM ad_campaigns WHERE user_id = '00000000-0000-0000-0000-000000000001';




